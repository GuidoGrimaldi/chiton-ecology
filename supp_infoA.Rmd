---
title: "Supp_A_Data_Exploration"
author: "G.Grimaldi"
date: "`r Sys.Date()`"
output:
  word_document:
    toc: yes
  pdf_document:
    toc: yes
  html_document:
    toc: yes
---

**Session Information:**
```{r echo=FALSE}
sI <- sessionInfo()
print(sI, RNG = FALSE, locale = FALSE)
```

**Load packages**
```{r message=FALSE, warning=FALSE}

library(beeswarm)   # for beeswarm()
library(car)        # for leveneTest()
library(FSA)        # for dunnTest ()
library(lattice)    # for dotplot(); xyplot()
library(rcompanion) # for cldList()
library(usdm)       # for vifstep()
library(vegan)      # for decostand()
```

# 1) Dataset Variables

 **Dataset**: "*chitons.data.csv*"

## a. Response Variable:
+ "*Chitons*": abundance of fluorescent chitons, i.e. *Ischnoplax pectinata* (G. B. Sowerby II, 1840).

## b. Explanatory Variable[^1]:
 + "*Site*": study sites.
 + "*Samp.Time*": sampling time (min).
 + "*Temp*": water temperature (°C).
 + "*Wt.level*": water level in relation to the base of the boulder (cm).
 + "*Weight*": boulder weight (Kg).
 + "*Boulder.area*": boulder surface area (cm^2^).
 + "*Exp.side.area*": exposed surface side area (cm^2^).
 + "*Flu.cover*": coverage of fluorescent substrates is the sum of '*Live.cca*' and '*Live.pey*' coverage (%).
 + "*Live.cca*": live crustose coralline algae, i.e. *Lithothamnium* sp. (%).
 + "*Live.pey*": live red soft crust algae, i.e. *Peyssonnelia* sp. (%).
 + "*N_flu.cover*": coverage of Nonfluorescent substrates is the sum of '*Dead.red.crust*' and '*N_flu.others*' coverage (%).
 + "*Dead.red.crust*": dead red crusts algae, i.e. *Lithothamnium* sp. and *Peyssonnelia* sp. together. (%).
 + "*N_flu.others*": coverage of "bare rock" and microbial mats (%).
 + "*Asc.cover*": coverage of ascidians (%).
 + "*Bryo.cover*": coverage of bryozoans (%).
 + "*Spong.cover*": coverage of sponges (%).
 + "*Others*": coverage of holes and unidentifiable substrates (%).
 
 [^1]: Coverage was measured on the sides of boulders.
 
```{r echo=FALSE}
side <- read.csv("chitons.data.csv", sep=";",dec=".", header=T)
str(side)
side$fSite <- factor(side$Site)
```

# 2) Data exploration

## a. Missing side ?
```{r results='hide'}
summary(side) # NO
```

## b. Balanced sampling ?
```{r}
tapply(side$Chitons,side$fSite,length) # YES
```

## c. Outliers Y & X ?

```{r}

# Boxplot
boxplot(decostand(side[,2:17],method="standardize"), ylab="Standardize value")

# Cleveland dotplot
dotplot(as.matrix(side[,2:17]), groups = FALSE,
        strip = strip.custom(bg = 'white',
                             par.strip.text = list(cex = 0.8)),
        scales = list(x = list(relation = "free"),
                      y = list(relation = "free"),
                      draw = FALSE),
        col = 1, cex  = 0.5, pch = 16,
        xlab = "Value of the variable",
        ylab = "Order of the side")

# Nothing particularly concerning.
```


## d. Normality Y ?
```{r}
# Histogram:
hist(side$Chitons, prob = T, breaks=15, ylim=c(0,1),
     xlab="Abundance of chitons", main="Histogram")
lines(density(side$Chitons), col="blue")

# it doesn't seem normal!

# QQ-plot:
qqnorm(side$Chitons)
qqline(side$Chitons, col="blue", lwd=2) 

# it doesn't seem normal either!

# Shapiro-Wilk's test:
shapiro.test(side$Chitons) # H0 rejected 

```

## e. Homogeneity Y?
```{r message=FALSE}

boxplot(Chitons~fSite, data=side) # I don't think so

variance <- tapply(side$Chitons,side$fSite,var)
variance

variance [2]/ variance [1]  # Buzios is 66x bigger than BF

# Teste de Bartlett:
bartlett.test(side$Chitons ~ side$fSite) # H0 rejected (Heteroscedastic)

# Teste de Fligner-Killeen:
fligner.test(side$Chitons ~ side$fSite) # H0 rejected (Heteroscedastic)

leveneTest(Chitons ~ fSite, data=side, center=mean) # H0 rejected (Heteroscedastic)

```

## f. Zero Trouble Y ?

```{r results='hide'}
# Frequency plot
table(side$Chitons)
barplot(table(side$Chitons), ylim=c(0,100),
        ylab="Frequency", xlab="Observed values")

# How many zeros? 
sum(side$Chitons==0)/length(side$Chitons)*100 # 63.33%

# Possible inflation, but not guaranteed (See: Warton, 2005)
```

Warton, D. I. (2005). Many zeros does not mean zero inflation: comparing the goodness-of-fit of parametric models to multivariate abundance data. Environmetrics 16(3), 275-289

## g. Collinearity X ?
```{r eval=TRUE, warning=FALSE, results='hide', fig.show='hide'}
# *pairs* fuctions:
panel.hist <- function(x, ...)
{
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(usr[1:2], 0, 1.5) )
  h <- hist(x, plot = FALSE)
  breaks <- h$breaks; nB <- length(breaks)
  y <- h$counts; y <- y/max(y)
  rect(breaks[-nB], 0, breaks[-1], y, col="cyan", ...)
}
  
panel.cor <- function(x, y, digits = 2, prefix = "", cex.cor, ...)
{
  usr <- par("usr"); on.exit(par(usr))
  par(usr = c(0, 1, 0, 1))
  r <- cor(x, y, method = "kendall")
  txt <- format(c(r, 0.123456789), digits = digits)[1]
  txt <- paste0(prefix, txt)
  if(missing(cex.cor)) cex.cor <- 0.8/strwidth(txt)
  text(0.5, 0.5, txt, cex = 1)
}

# Scatterplots correlations
pairs(side[,3:17],panel=panel.smooth, diag.panel=panel.hist, lower.panel=panel.cor)
```

Collinear Variables:

  + Weight ~ Boulder.area (0.68)
  + Weight ~ Exp.side.area (0.56)
  + Boulder.area ~ Exp.side.area (0.47)
  + Flu.cover ~ Live.cca (0.72)
  + Flu.cover ~ N_flu.cover (-0.63)
  + Live.cca ~ N_flu.cover (-0.56)
  + N_flu.cover ~ Dead.red.crust (0.39)

```{r}
# Variance Inflation Factor
X<-side[,3:17]
vifstep(X, th=3,keep = "Flu.cover")
```

## h. Relationships Y & X

```{r warning=FALSE}
# Scatterplots 
pairs(side[,c(2:10)], panel=panel.smooth, diag.panel=panel.hist, lower.panel=panel.cor)

pairs(side[,c(2,11:17)], panel=panel.smooth, diag.panel=panel.hist, lower.panel=panel.cor)
```

There are no clear patterns between the response and explanatory variables, except perhaps for the Water level.

**Chitons ~ Flu.cover | Site**
```{r}
xyplot(Chitons ~ Flu.cover | Site, data=side, type=c("p","r"))
```

**Chitons ~ Wt.level | Site**
```{r}
xyplot(Chitons ~ Wt.level | Site, data=side, type=c("p","r"))
```

**Chitons ~ Boulder.area | Site**
```{r}
xyplot(Chitons ~ Boulder.area | Site, data=side, type=c("p","r"))
```

**Chitons ~ Exp.side.area | Site**
```{r}
xyplot(Chitons ~ Exp.side.area | Site, data=side, type=c("p","r"))
```

**Chitons ~ Weight | Site**
```{r}
xyplot(Chitons ~ Weight | Site, data=side, type=c("p","r"))
```

**Chitons ~ Samp.time | Site**
```{r}
xyplot(Chitons ~ Samp.time | Site, data=side, type=c("p","r"))
```

**Chitons ~ Live.cca | Site**
```{r}
xyplot(Chitons ~ Live.cca | Site, data=side, type=c("p","r"))
```

**Chitons ~ Live.pey | Site**
```{r}
xyplot(Chitons ~ Live.pey | Site, data=side, type=c("p","r"))
```

**Chitons ~ N_flu.cover | Site**
```{r}
xyplot(Chitons ~ N_flu.cover | Site, data=side, type=c("p","r"))
```

**Chitons ~ Dead.red.crust | Site**
```{r}
xyplot(Chitons ~ Dead.red.crust | Site, data=side, type=c("p","r"))
```

**Chitons ~ Asc.cover | Site**
```{r}
xyplot(Chitons ~ Asc.cover | Site, data=side, type=c("p","r"))
```

**Chitons ~ Bryo.cover | Site**
```{r}
xyplot(Chitons ~ Bryo.cover | Site, data=side, type=c("p","r"))
```

**Chitons ~ Spong.cover | Site**
```{r}
xyplot(Chitons ~ Spong.cover | Site, data=side, type=c("p","r"))
```

**Chitons ~ Others | Site**
```{r}
xyplot(Chitons ~ Others | Site, data=side, type=c("p","r"))
```


## i. Interactions

**Chitons ~ Flu.cover | Boulder.area * Wt.level**
```{r,fig.width=9, fig.height=9}
par(mfrow=c(1,1), mar = c(5,4,2,1))
coplot(Chitons ~ Flu.cover | Boulder.area*Wt.level, data=side, 
       ylab = "Abundance",
       xlab = "Fluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })

```
**Chitons ~ Flu.cover | Exp.side.area * Wt.level**
```{r, fig.width=9, fig.height=9}
coplot(Chitons ~ Flu.cover | Exp.side.area*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Fluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })

```
**Chitons ~ Flu.cover | Weight * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Flu.cover | Weight*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Fluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Flu.cover | Bryo.cover * Weight**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Flu.cover | Bryo.cover*Weight, data=side,
       ylab = "Abundance",
       xlab = "Fluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Flu.cover | Bryo.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Flu.cover | Bryo.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Fluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Flu.cover | Asc.cover * Exp.side.area**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Flu.cover | Asc.cover*Exp.side.area, data=side,
       ylab = "Abundance",
       xlab = "Fluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Flu.cover | Asc.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Flu.cover | Asc.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Fluorescence cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```


**Chitons ~ Live.cca | Exp.side.area * Wt.level**
```{r, fig.width=9, fig.height=9}
coplot(Chitons ~ Live.cca | Exp.side.area*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "CCA cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })

```
**Chitons ~ Live.cca | Weight * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.cca | Weight*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "CCA cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.cca | Bryo.cover * Weight**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.cca | Bryo.cover*Weight, data=side,
       ylab = "Abundance",
       xlab = "CCA cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.cca | Bryo.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.cca | Bryo.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "CCA cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.cca | Asc.cover * Exp.side.area**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.cca | Asc.cover*Exp.side.area, data=side,
       ylab = "Abundance",
       xlab = "CCA cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.cca | Asc.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.cca | Asc.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "CCA cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```

**Chitons ~ Live.pey | Exp.side.area * Wt.level**
```{r, fig.width=9, fig.height=9}
coplot(Chitons ~ Live.pey | Exp.side.area*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Peyssonnelia cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })

```
**Chitons ~ Live.pey | Weight * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.pey | Weight*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Peyssonnelia cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.pey | Bryo.cover * Weight**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.pey | Bryo.cover*Weight, data=side,
       ylab = "Abundance",
       xlab = "Peyssonnelia cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.pey | Bryo.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.pey | Bryo.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Peyssonnelia cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.pey | Asc.cover * Exp.side.area**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.pey | Asc.cover*Exp.side.area, data=side,
       ylab = "Abundance",
       xlab = "Peyssonnelia cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Live.pey | Asc.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Live.pey | Asc.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Peyssonnelia cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```

**Chitons ~ N_flu.cover | Exp.side.area * Wt.level**
```{r, fig.width=9, fig.height=9}
coplot(Chitons ~ N_flu.cover | Exp.side.area*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Nonfluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })

```
**Chitons ~ N_flu.cover | Weight * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ N_flu.cover | Weight*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Nonfluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ N_flu.cover | Bryo.cover * Weight**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ N_flu.cover | Bryo.cover*Weight, data=side,
       ylab = "Abundance",
       xlab = "Nonfluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ N_flu.cover | Bryo.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ N_flu.cover | Bryo.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Nonfluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ N_flu.cover | Asc.cover * Exp.side.area**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ N_flu.cover | Asc.cover*Exp.side.area, data=side,
       ylab = "Abundance",
       xlab = "Nonfluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ N_flu.cover | Asc.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ N_flu.cover | Asc.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Nonfluorescent cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```

**Chitons ~ Dead.red.crust | Exp.side.area * Wt.level**
```{r, fig.width=9, fig.height=9}
coplot(Chitons ~ Dead.red.crust | Exp.side.area*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Dead red crust algae  cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })

```
**Chitons ~ Dead.red.crust | Weight * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Dead.red.crust | Weight*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Dead red crust algae  cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Dead.red.crust | Bryo.cover * Weight**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Dead.red.crust | Bryo.cover*Weight, data=side,
       ylab = "Abundance",
       xlab = "Dead red crust algae cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Dead.red.crust | Bryo.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Dead.red.crust | Bryo.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Dead red crust algae cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Dead.red.crust | Asc.cover * Exp.side.area**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Dead.red.crust | Asc.cover*Exp.side.area, data=side,
       ylab = "Abundance",
       xlab = "Dead red crust algae cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```
**Chitons ~ Dead.red.crust | Asc.cover * Wt.level**
```{r ,fig.width=9, fig.height=9}
coplot(Chitons ~ Dead.red.crust | Asc.cover*Wt.level, data=side,
       ylab = "Abundance",
       xlab = "Dead red crust algae cover (%)",
       panel = function(x, y, ...) {
         tmp <- lm(y ~ x, na.action = na.omit)
         abline(tmp)
         points(x, y) })
```


# 3) Variable statistics

## a. *Chitons*

**General Informations**

*Total chiton abundance:*
```{r}
# Total chiton abundance?
sum(side$Chitons) # 137
```

*Max abundance in a boulder:*
```{r}
# Max abundance in a boulder?
max(side$Chitons) # 15
```

*Percentage of occupied boulders:*

```{r}
# Percentage of occupied boulders?
boulders <- length(side$Chiton)
occupied <- length(side$Chiton[side$Chiton!=0])
percentage <- (occupied*100)/boulders
percentage # 36.6 % occupied boulders
```

*Encounter Rate:*
```{r}
# Encounter rate
enc.rate <- sum(side$Chitons)/sum(side$Samp.time)
enc.rate # 0.15 chitons/min
enc.rate*60 # 9.35 chitons/hour
```

*Density*
```{r}
# Density
area <- (sum(side$Boulder.area)/100) 
chitons <- sum(side$Chitons)
density <- chitons/area
density  # 0.427 individuals/m^2
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,1), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(side$Chitons~side$fSite, ylab="Abundance",xlab="")
```
*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Chitons,side$Site,max)
```

*Average:*
```{r echo=FALSE}
# Average:
tapply(side$Chitons,side$Site,mean)
```

*Standard deviations:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Chitons,side$Site,sd)
```

*Formal test:*
```{r}
# Kruskal-Wallis
kruskal.test(Chitons~fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Chitons ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```


## b. *Samp.time*

**General informations**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing:
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Samp.time, prob = T, ylim=c(0,0.5),breaks = 10, xlab="Sampling time (min)", main = "Histogram")
lines(density(side$Samp.time), col="blue")
dotchart(side$Samp.time, xlab = "Sampling time (min)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Samp.time)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Samp.time)
```

*Total Sampling time (min):*
```{r echo=FALSE}
# Total sampling time
sum(side$Samp.time) 
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(side$Samp.time~side$fSite, ylab="Samping time (min)", xlab="")
dotchart(side$Samp.time, xlab = "Sampling time (min)", group=side$fSite)
```

*Total Sampling time:*
```{r echo=FALSE}
# Total Sampling time:
tapply(side$Samp.time,side$Site,sum)
```

*Average:*
```{r echo=FALSE}
# Average Sampling time:
tapply(side$Samp.time,side$Site,mean)
```

*Standard deviations:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Samp.time,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Samp.time ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Samp.time ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```


## c. *Temp*
**General information**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Temp, prob = T, ylim=c(0,0.5),breaks = 10, xlab="Water temperature (°C)", main = "Histogram")
lines(density(side$Temp), col="blue")
dotchart(side$Temp, xlab = "Water temperature (°C)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Temp)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Temp)
```

**Comparison among reefs**

*Visual exploration:*
```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(side$Temp~side$fSite, ylab="Water temperature (°C)", xlab="")
dotchart(side$Temp, xlab = "Water temperature (°C)", group=side$fSite)

```

*Maximum:*
```{r echo=FALSE}
# Maximum temperature
tapply(side$Temp,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum temperature
tapply(side$Temp,side$Site,min)
```

*Average:*
```{r echo=FALSE}
# Average temperature:
tapply(side$Temp,side$Site,mean)
```

*Standard deviations:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Temp,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Temp ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Temp ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## d. *Wt.level*
**General information**

*Visual exploration*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Wt.level, prob = T, ylim=c(0,0.05), breaks = 10, xlab="Water level (mm)", main = "Histogram")
lines(density(side$Wt.level), col="blue")
dotchart(side$Wt.level, xlab = "Water level (mm)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Wt.level)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Wt.level)
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(side$Wt.level~side$fSite, ylab="Water level (mm)",xlab="")
dotchart(side$Wt.level, xlab = "Water level (mm)",group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum Wt.level:
tapply(side$Wt.level,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum Wt.level:
tapply(side$Wt.level,side$Site,min)
```

*Average:*
```{r echo=FALSE}
# Average Wt.level:
tapply(side$Wt.level,side$Site,mean)
```

*Standard deviations:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Wt.level,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Wt.level ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Wt.level ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## e. *Weight*
**General information**

*Visual exploration:*

```{r echo=FALSE}
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Weight, prob = T, ylim=c(0,0.2), breaks = 10, xlab="Boulder's weight (Kg)", main = "Histogram")
lines(density(side$Weight), col="blue")
dotchart(side$Weight, xlab = "Boulder's weight (Kg)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Weight)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Weight)
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Weight~fSite, data=side, ylab="Boulders weight (Kg)",xlab="")
dotchart(side$Weight, xlab = "Boulders weight (Kg)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum Weight:
tapply(side$Weight,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum Weight:
tapply(side$Weight,side$Site,min)
```

*Average:*
```{r echo=FALSE}
# Average Weight:
tapply(side$Weight,side$Site,mean)
```

*Standard deviations:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Weight,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Weight ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Weight ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```


## f. *Boulder.area*
**General infomations**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Boulder.area, prob = T, ylim=c(0,0.01),breaks = 15, xlab="Boulder surface area (mm)", main = "Histogram")
lines(density(side$Boulder.area), col="blue")
dotchart(side$Boulder.area, xlab = "Boulder surface area (mm)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Boulder.area)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Boulder.area)
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Boulder.area~fSite, data=side, ylab="Boulder surface area (mm)",xlab="")
dotchart(side$Boulder.area, xlab = "Boulder surface area (mm)", group=side$fSite)
```

*Total boulder area (cm^2^):*
```{r echo=FALSE}
# Total boulder area:
tapply(side$Boulder.area,side$Site,sum)

```

*Maximum:*
```{r echo=FALSE}
# Maximum Boulder.area:
tapply(side$Boulder.area,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum Boulder.area:
tapply(side$Boulder.area,side$Site,min)
```

*Average:*
```{r echo=FALSE}
# Average Boulder.area:
tapply(side$Boulder.area,side$Site,mean)
```

*Standard deviations:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Boulder.area,side$Site,sd)
```

*Formal test:*
```{r}
# Kruskal-Wallis
kruskal.test(Boulder.area~fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Boulder.area ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## g. *Exp.side.area*
**General Information**

*Visual Exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Exp.side.area, prob = T, ylim=c(0,0.01),breaks = 10, xlab="Exposed side surface (cm²)", main = "Histogram")
lines(density(side$Exp.side.area), col="blue")
dotchart(side$Exp.side.area, xlab = "Exposed side surface (cm²)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Exp.side.area)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Exp.side.area)
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Exp.side.area~fSite, data=side, ylab="Exposed side surface (cm²)",xlab="")
dotchart(side$Exp.side.area, xlab = "Exposed side surface (cm²)", group=side$fSite)
```

*Total exposed side surface area (cm^2^):*
```{r echo=FALSE}
# Total Exposed side surface area:
tapply(side$Exp.side.area,side$Site,sum)

```

*Maximum:*
```{r echo=FALSE}
# Maximum Exp.side.area:
tapply(side$Exp.side.area,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum Exp.side.area:
tapply(side$Exp.side.area,side$Site,min)
```

*Average:*
```{r echo=FALSE}
# Average Exp.side.area:
tapply(side$Exp.side.area,side$Site,mean)
```

*Standard deviations:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Exp.side.area,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Exp.side.area ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Exp.side.area ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```


## h. *Flu.cover*
**General information**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Flu.cover, prob = T, ylim=c(0,0.05),breaks = 15, xlab="Fluorescent substrate (%)", main = "Histogram")
lines(density(side$Flu.cover), col="blue")
dotchart(side$Flu.cover, xlab = "Fluorescent substrate (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Flu.cover)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Flu.cover)
```

*Percentage of boulders with red crust algae on the sides?*
```{r}
boulders <- length(side$Site)
occupied <- length(side$Flu.cover[side$Flu.cover!=0])
percentage <- (occupied*100)/boulders
percentage # Red crust algae is present on the side faces of all boulders.

```

**Comparison among reefs**

*Visual exploration*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Flu.cover~fSite, data=side, ylab="Fluorescent substrate (%)",xlab="")
dotchart(side$Flu.cover, xlab = "Fluorescent substrate (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Flu.cover,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum:
tapply(side$Flu.cover,side$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average fluorescent substrate cover:
tapply(side$Flu.cover,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Flu.cover,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Flu.cover ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Flu.cover ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction  
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## i. *Live.cca*
**General information**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Live.cca, prob = T, ylim=c(0,0.05),breaks = 15, xlab="CCA cover (%)", main = "Histogram")
lines(density(side$Live.cca), col="blue")
dotchart(side$Live.cca, xlab = "CCA cover (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Live.cca)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Live.cca)
```

*Percentage of boulders with live Crustose Coralline Algae on the side face?*

```{r}
boulders <- length(side$Site)
occupied <- length(side$Live.cca[side$Live.cca!=0])
percentage <- (occupied*100)/boulders
percentage # CCA is present on the side face of all boulders.

```
**Comparison among reefs**

*Visual exploration*
 
```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Live.cca~fSite, data=side, ylab="CCA cover (%)",xlab="")
dotchart(side$Live.cca, xlab = "CCA cover (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Live.cca,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum:
tapply(side$Live.cca,side$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$Live.cca,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Live.cca,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Live.cca ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Live.cca ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction  
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```


## j. *Live.pey*
**General information**

*Visual exploration:*

```{r echo=FALSE}
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Live.pey, prob = T, ylim=c(0,0.2),breaks = 15, xlab="Peyssonnelia cover (%)", main = "Histogram")
lines(density(side$Live.pey), col="blue")
dotchart(side$Live.pey, xlab = "Peyssonnelia cover (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Live.pey)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Live.pey)
```

*Percentage of boulders with Peyssonnelia crust algae on the sides?*

```{r}
boulders <- length(side$Site)
occupied <- length(side$Live.pey[side$Live.pey!=0])
percentage <- (occupied*100)/boulders
percentage # Peyssonnelia crusts are present on the side faces of 66% of the boulders.

```

**Comparison among reefs**

*Visual exploration*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Live.pey~fSite, data=side, ylab="Peyssonnelia cover (%)",xlab="")
dotchart(side$Live.pey, xlab = "Peyssonnelia cover (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Live.pey,side$Site,max)
```

*Non-zero minimum :*
```{r echo=FALSE}
# Minimum:
fill_Live.pey <- side[side$Live.pey !=0,]
tapply(fill_Live.pey$Live.pey,fill_Live.pey$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$Live.pey,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Live.pey,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Live.pey ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Dunn's Kruskal-Wallis Multiple Comparisons
DT = dunnTest(Live.pey ~ fSite,
              data=side,
              method="bonferroni")   # Bonferroni correction  
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## k. *N_flu.cover*
**General information**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$N_flu.cover, prob = T, ylim=c(0,0.05),breaks = 15, xlab="Nonfluorescent substrates cover (%)", main = "Histogram")
lines(density(side$N_flu.cover), col="blue")
dotchart(side$N_flu.cover, xlab = "Nonfluorescent substrates cover (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$N_flu.cover)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$N_flu.cover)
```

*Percentage of boulders with red crust algae on the sides?*

```{r}
boulders <- length(side$Site)
occupied <- length(side$N_flu.cover[side$N_flu.cover!=0])
percentage <- (occupied*100)/boulders
percentage # Nonfluorescent substrates are present on the side face of all boulders.

```

**Comparison among reefs**

*Visual exploration*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(N_flu.cover~fSite, data=side, ylab="Nonfluorescent substrates (%)",xlab="")
dotchart(side$N_flu.cover, xlab = "Nonfluorescent substrates (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$N_flu.cover,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum:
tapply(side$N_flu.cover,side$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$N_flu.cover,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$N_flu.cover,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(N_flu.cover ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Comparisons between reefs:
DT = dunnTest(N_flu.cover ~ fSite,
              data=side,
              method="bonferroni")      
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```


## l. *Dead.red.crust*
**General Information**

*Visual exploration:*

```{r echo=FALSE}
# Vizualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Dead.red.crust, prob = T, ylim=c(0,0.1), xlab="Dead red crust cover (%)", main = "Histogram")
lines(density(side$Dead.red.crust), col="blue")
dotchart(side$Dead.red.crust, xlab = "Dead red crust cover (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Dead.red.crust)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Dead.red.crust)
```

*Percentage of boulders with dead red crust algae on the sides?*

```{r}
boulders <- length(side$Site)
occupied <- length(side$Dead.red.crust[side$Dead.red.crust!=0])
percentage <- (occupied*100)/boulders
percentage # Dead red crust is present on the side faces of 95% of the boulders.
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Dead.red.crust~fSite, data=side, ylab="Dead red crust (%)",xlab="")
dotchart(side$Dead.red.crust, xlab = "Dead red crust (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Dead.red.crust,side$Site,max)
```

*Minimum:*
```{r echo=FALSE}
# Minimum:
tapply(side$Dead.red.crust,side$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$Dead.red.crust,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Dead.red.crust,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Dead.red.crust ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Comparisons between reefs:
DT = dunnTest(Dead.red.crust ~ fSite,
              data=side,
              method="bonferroni")      
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## m. *Asc.cover*
**General Informations**

*Visual Exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Asc.cover, prob = T, ylim=c(0,0.2), breaks = 10, xlab="Ascidian cover (%)", main = "Histogram")
lines(density(side$Asc.cover), col="blue")
dotchart(side$Asc.cover, xlab = "Ascidian cover(%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Asc.cover)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Asc.cover)
```

*Percentage of boulders with ascidians on the sides?*
```{r}
boulders <- length(side$Site)
occupied <- length(side$Asc.cover[side$Asc.cover!=0])
percentage <- (occupied*100)/boulders
percentage # Ascidians are present on the side faces of 78.33% of the boulders.

```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Asc.cover~fSite, data=side, ylab="Ascidian cover (%)",xlab="")
dotchart(side$Asc.cover, xlab = "Ascidian cover (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Asc.cover,side$Site,max)
```

*Non-zero minimum :*
```{r echo=FALSE}
# Minimum:
fill_Asc.cover <- side[side$Asc.cover !=0,]
tapply(fill_Asc.cover$Asc.cover,fill_Asc.cover$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$Asc.cover,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Asc.cover,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Asc.cover ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Comparisons between reefs:
DT = dunnTest(Asc.cover ~ fSite,
              data=side,
              method="bonferroni")      
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## n. *Bryo.cover*
**General Information**

*Visual Exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Bryo.cover, prob = T, ylim=c(0,0.5), breaks = 15, xlab="Bryozoan cover (%)", main = "Histogram")
lines(density(side$Bryo.cover), col="blue")
dotchart(side$Bryo.cover, xlab = "Bryozoan cover (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Bryo.cover)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Bryo.cover)
```

*Percentage of boulders with bryozoans on the sides:*

```{r}
boulders <- length(side$Site)
occupied <- length(side$Bryo.cover[side$Bryo.cover!=0])
percentage <- (occupied*100)/boulders
percentage # Bryozoans are present on the side faces of 26.66% of the boulders.

```

*Percentage of zeros:*
```{r}
sum(side$Bryo.cover==0)/length(side$Bryo.cover)*100 # 73.33%
```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Bryo.cover~fSite, data=side, ylab="Bryozoan cover (%)",xlab="")
dotchart(side$Bryo.cover, xlab = "Bryozoan cover (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Bryo.cover,side$Site,max)
```

*Non-zero minimum :*
```{r echo=FALSE}
# Minimum:
fill_Bryo.cover <- side[side$Bryo.cover !=0,]
tapply(fill_Bryo.cover$Bryo.cover,fill_Bryo.cover$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$Bryo.cover,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Bryo.cover,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Bryo.cover ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Comparisons between reefs:
DT = dunnTest(Bryo.cover ~ fSite,
              data=side,
              method="bonferroni")      
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## o. *Spong.cover*
**General Information**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Spong.cover, prob = T, ylim=c(0,0.8), breaks = 15, xlab="Sponge cover (%)", main = "Histogram")
lines(density(side$Spong.cover), col="blue")
dotchart(side$Spong.cover, xlab = "Sponge cover (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Spong.cover)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Spong.cover)
```

*Percentage of boulders with sponges on the sides?*

```{r}
boulders <- length(side$Site)
occupied <- length(side$Spong.cover[side$Spong.cover!=0])
percentage <- (occupied*100)/boulders
percentage # Sponges are present on the side faces of 57.5% of the boulders.

```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Spong.cover~fSite, data=side, ylab="Sponges cover (%)",xlab="")
dotchart(side$Spong.cover, xlab = "Sponges cover (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Spong.cover,side$Site,max)
```

*Non-zero minimum :*
```{r echo=FALSE}
# Minimum:
fill_Spong.cover <- side[side$Spong.cover !=0,]
tapply(fill_Spong.cover$Spong.cover,fill_Spong.cover$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$Spong.cover,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Spong.cover,side$Site,sd)
```

*Formal test:*

```{r}
kruskal.test(Spong.cover ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Comparisons between reefs:
DT = dunnTest(Spong.cover ~ fSite,
              data=side,
              method="bonferroni")      
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```

## p. *Others*
**General Information**

*Visual exploration*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1))
hist(side$Others, prob = T, ylim=c(0,0.5),breaks = 10, xlab="Others coverage (%)", main = "Histogram")
lines(density(side$Others), col="blue")
dotchart(side$Others, xlab = "Others coverage (%)",
         ylab = "Order of the data", main = "Dotplot")
```

*Summary:*
```{r echo=FALSE}
# Summary
summary(side$Others)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard Deviation
sd(side$Others)
```

*Percentage of boulders with red crust algae on the sides?*

```{r}
boulders <- length(side$Site)
occupied <- length(side$Others[side$Others!=0])
percentage <- (occupied*100)/boulders
percentage # Others coverage are present in 65%.

```

**Comparison among reefs**

*Visual exploration:*

```{r echo=FALSE}
# Visualizing
par(mfrow=c(1,2), mar = c(5,4,2,1), cex.axis=0.6)
boxplot(Others~fSite, data=side, ylab="Others coverage (%)",xlab="")
dotchart(side$Others, xlab = "Others coverage (%)", group=side$fSite)
```

*Maximum:*
```{r echo=FALSE}
# Maximum:
tapply(side$Others,side$Site,max)
```

*Non-zero minimum :*
```{r echo=FALSE}
# Minimum:
fill_Others <- side[side$Others !=0,]
tapply(fill_Others$Others,fill_Others$Site,min)
```

*Average:* 
```{r echo=FALSE}
# Average:
tapply(side$Others,side$Site,mean)
```

*Standard deviation:*
```{r echo=FALSE}
# Standard deviations:
tapply(side$Others,side$Site,sd)
```

*Formal test:*
```{r}
kruskal.test(Others ~ fSite, data=side)
```

*Post-hoc test:*
```{r}
# Comparisons between reefs:
DT = dunnTest(Others ~ fSite,
              data=side,
              method="bonferroni")      
PT = DT$res
cldList(P.adj ~ Comparison,
        data = PT,
        threshold = 0.05)
```


